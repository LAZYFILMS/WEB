<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAZY FILM LAB</title>

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Stratos:wght@900&display=swap" rel="stylesheet" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Agrandir:wght@400;700&display=swap" rel="stylesheet" as="style">

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <!-- Constants and Configuration -->
    <script>
        const PRICE_PER_ROLL = 700;
        const SHOPIFY_STORE_NAME = 'rphzqx-d5.myshopify.com';
        const STOREFRONT_ACCESS_TOKEN = 'b7434c05596772a5b7b847ac6beb9aba';
        // Variant IDs for upsell products (discounted 10% variants)
        let VARIANT_LAZY500 = '43637440315491'; // LAZY 500 10% variant
        let VARIANT_LAZY250 = '43637439725667'; // LAZY 250 10% variant
        // No discount code used; pricing/discount handled in Shopify
        // Express processing configuration
        const EXPRESS_FEE_PER_ROLL = 500; // â‚¹500 per roll
        // Optional: Shopify variant to charge Express per roll (hidden product recommended)
        // Can be overridden via URL param: ?express=gid://shopify/ProductVariant/123 or 123
        let EXPRESS_VARIANT_ID = '43760587767907';
    </script>
</head>
<style>
    /* General Styles */
    body {
        font-family: "Lucida Console", Courier, monospace;
        margin: 0;
        padding: 0;
        background: #fff;
        color: #000;
    }

    .container {
        max-width: 650px;
        margin: 20px auto;
        padding: 30px;
        border: 2px solid #000;
        border-radius: 8px;
        background-color: #f9f9f9;
        min-height: auto;
    }

    /* Header Styles */
    header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .title {
        font-family: 'Stratos', sans-serif;
        font-size: 24px;
        margin: 0;
        font-weight: bold;
    }

    .email-link {
        font-family: 'Stratos', sans-serif;
        text-decoration: none;
        color: #000;
        font-size: 24px;
        font-weight: bold;
        text-decoration: underline;
    }

    /* Carousel Styles */
    .carousel {
        position: relative;
        width: 100%;
        padding-bottom: 66.67%;  /* This creates a 3:2 aspect ratio */
        overflow: hidden;
        border: 1px solid #000;
        border-radius: 6px;
        margin: 15px 0;
    }

    .carousel img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: none;
        object-fit: cover;
    }

    .carousel img.active {
        display: block;
    }

    /* Form and Input Styles */
    .form-group {
        margin-bottom: 15px;
    }

    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }

    .form-group input {
        width: 100%;
        padding: 8px;
        border: 1px solid #000;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
    }

    /* Order Box Styles */
    .order-box {
        margin-top: 20px;
        background: #ffffff;
        border-radius: 16px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        overflow: hidden;
        padding: 32px;
    }

    .add-roll-btn {
        background: #000;
        color: #fff;
        padding: 8px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        height: 36px;
        min-width: 100px;
        margin-bottom: 20px;
    }

    .roll-row {
        display: grid;
        grid-template-columns: 1.5fr 80px 120px 120px auto;
        gap: 10px;
        align-items: center;
        margin-bottom: 15px;
        padding: 5px 0;
        border-bottom: 1px solid #eee;
    }

    .roll-row input[type="text"],
    .roll-row input[type="number"],
    .roll-row select {
        padding: 8px;
        font-size: 14px;
        height: 36px;
        border: 1px solid #000;
        border-radius: 4px;
        box-sizing: border-box;
        background: white;
        cursor: text;
    }

    /* Cart Summary Styles */
    .cart-summary {
        margin: 25px 0;
        padding: 20px;
        border: 2px solid #000;
        border-radius: 8px;
    }

    .cart-items {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .cart-item {
        font-size: 14px;
        padding: 6px 0;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .cart-total {
        font-size: 18px;
        font-weight: bold;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 2px solid #000;
    }

    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        justify-content: center;
        align-items: center;
    }

    .modal.active {
        display: flex;
    }

    .modal-content {
        background-color: #f9f9f9;
        padding: 30px;
        border: 2px solid #000;
        border-radius: 8px;
        width: 90%;
        max-width: 420px; /* slightly narrower to make it taller and images more prominent */
        position: relative;
    }

    /* Upsell copy tuning */
    #upsellModal .modal-content p {
        font-size: 13px;      /* slightly smaller */
        line-height: 1.5;     /* slightly more space between lines */
    }

    .modal-buttons {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }

    .modal-buttons button {
        flex: 1;
        padding: 12px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
    }

    .confirm-order {
        background: #000;
        color: #fff;
    }

    .cancel-order {
        background: #f1f1f1;
    }

    .place-order {
        display: block;
        width: 100%;
        padding: 15px;
        background: #000;
        color: #fff;
        border: none;
        border-radius: 4px;
        font-size: 16px;
        cursor: pointer;
        margin-top: 20px;
    }

    /* Additional Elements Styles */
    .scans {
        margin: 20px 0;
        padding-left: 0;
    }

    .scans h3 {
        margin-bottom: 10px;
        font-family: "Lucida Console", Courier, monospace;
        font-weight: bold;
    }

    .scans-options {
        display: flex;
        gap: 20px;
    }

    .return-negatives-container {
        margin: 20px 0;
    }

    textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #000;
        border-radius: 4px;
        margin: 20px 0;
        min-height: 100px;
        font-family: inherit;
        box-sizing: border-box;
    }

    /* Mobile Responsive Styles */
    @media (max-width: 768px) {
        .container {
            width: 90%;
            margin: 10px auto;
            padding: 15px;
            box-sizing: border-box;
        }

        /* Clear specific width for label and address boxes */
        .label-format-box,
        .address-box {
            width: 95% !important;
            margin: 15px auto;
            box-sizing: border-box;
            padding: 15px 15px 15px 20px;  /* top right bottom left */
            border: 1px solid #000;
            clear: both;
            display: block;
        }

        /* Ensure content inside boxes fits properly */
        .label-format-box *,
        .address-box * {
            max-width: 100%;
            box-sizing: border-box;
        }

        /* Add consistent text padding */
        p, h2, h3, label {
            padding: 0 15px;
            margin: 10px 0;
            box-sizing: border-box;
        }

        /* Text size adjustments */
        .info-section p,
        .label-format-box p:not(.label-format-heading),
        .address-box p:not(.address-heading) {
            font-size: 14px;
            line-height: 1.4;
            padding: 0 10px;
        }

        .roll-row {
            grid-template-columns: 1fr;
            gap: 10px;
        }

        /* Form elements */
        textarea, 
        .roll-row input,
        .roll-row select {
            width: 100%;
            box-sizing: border-box;
        }

        /* Cart and order elements */
        .cart-summary,
        .place-order {
            width: 100%;
            box-sizing: border-box;
            margin: 15px 0;
        }

        .scans {
            margin: 10px 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding-left: 15px;
        }

        .scans h3 {
            padding-left: 0;
            margin-bottom: 8px;
        }

        .scans-options {
            flex-direction: row;
            justify-content: flex-start;
            gap: 8px;
            padding-left: 15px;
            flex-wrap: nowrap;
            width: auto;
        }

        /* Info sections */
        .info-sections {
            width: 100%;
            margin: 20px auto;
            padding: 0;
        }

        .info-section h2 {
            font-size: 24px;
            margin-bottom: 15px;
        }

        .label-format-image {
            width: 180px;
            margin: 15px auto 0 -30px;
        }

        /* Cart Drawer Mobile Styles */
        .cart-drawer {
            width: 100%;
            right: -100%;
        }

        .cart-drawer.active {
            right: 0;
        }

        .cart-drawer-header h3 {
            font-size: 20px;
        }

        .cart-items-container {
            max-height: calc(100vh - 180px);
        }

        /* Modal Mobile Styles */
        .modal-content {
            width: 92%;
            max-width: 360px;
            max-height: 85vh;
        }

        /* Upsell mobile sizing */
        #upsellModal .modal-content img[alt="LAZY 500"],
        #upsellModal .modal-content img[alt="LAZY 250"] {
            width: 72px;
        }
        #upsellModal .modal-content .quantity-control input {
            width: 64px;
            height: 32px;
        }
        #upsellModal .modal-content .qty-btn {
            width: 22px;
        }

        /* Footer Mobile Styles */
        footer {
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }

        footer a {
            font-size: 11px;
        }

        .carousel {
            margin: 10px 0;
            border-radius: 4px;
        }

        /* Align return negatives checkbox */
        .return-negatives-container {
            padding-left: 15px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Reset any padding from general rules */
        .scans-options label,
        .return-negatives-container label {
            padding: 0;
        }

        /* Control text width and wrapping in info sections */
        .info-section p,
        .label-format-box p,
        .address-box p {
            max-width: 100%;
            word-wrap: break-word;
            margin-left: 0;
            line-height: 1.6;
            font-size: 14px;
        }

        /* Adjust heading width */
        .info-section h2,
        .label-format-heading,
        .address-heading {
            max-width: 100%;
            margin-left: 0;
        }

        /* Fix text alignment in info sections */
        .info-section {
            width: 100%;
            padding: 0 15px 0 22px;
            box-sizing: border-box;
        }

        /* FAQ and How it works sections */
        .info-section:not(.label-format-box):not(.address-box) {
            max-width: 380px;
            margin-left: 22px;
        }

        .info-section:not(.label-format-box):not(.address-box) p {
            max-width: 380px;
            word-wrap: break-word;
            margin: 10px 0;
            padding: 0;
            line-height: 1.4;
        }

        .info-section:not(.label-format-box):not(.address-box) h2 {
            max-width: 380px;
            word-wrap: break-word;
            margin: 15px 0;
            padding: 0;
        }

        /* Make header text 80% of original size */
        .title,
        .email-link {
            font-size: 19px;  /* Original was 24px, now 80% of original */
            margin: 0;
        }

        /* Adjust header spacing */
        header {
            margin-bottom: 15px;
            padding: 5px 0;
        }
    }

    /* Small phones */
    @media (max-width: 375px) {
        .title, .email-link {
            font-size: 18px;
        }

        .info-section h2 {
            font-size: 22px;
        }

        .label-format image {
            width: 150px;
        }
    }

    /* Universal Cart Styles */
    .universal-cart-button {
        position: fixed;
        bottom: 30px;
        right: 30px;
        background: #000;
        color: #fff;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        z-index: 1000;
        transition: transform 0.2s;
    }

    .universal-cart-button:hover {
        transform: scale(1.05);
    }

    .cart-count-bubble {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #ff0000;
        color: #fff;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
    }

    /* Cart Drawer Styles */
    .cart-drawer {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100vh;
        background: #fff;
        box-shadow: -4px 0 12px rgba(0,0,0,0.1);
        z-index: 1001;
        transition: right 0.3s;
        padding: 20px;
        box-sizing: border-box;
    }

    .cart-drawer.active {
        right: 0;
    }

    .cart-drawer-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #eee;
    }

    .cart-items-container {
        max-height: calc(100vh - 200px);
        overflow-y: auto;
    }

    .cart-item {
        display: flex;
        padding: 15px;
        border-bottom: 1px solid #eee;
        justify-content: space-between;
        align-items: center;
    }

    .cart-item-details {
        flex: 1;
        margin-right: 15px;
    }

    .cart-item-details h4 {
        font-family: "stratos-black", sans-serif;
        font-size: 16px;
        margin: 0 0 5px 0;
    }

    .cart-item-details p {
        font-size: 14px;
        margin: 0;
        color: #666;
    }

    .cart-item button {
        background: #fff;
        color: #ff0000;
        border: 1px solid #ff0000;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.2s;
    }

    .cart-item button:hover {
        background: #ff0000;
        color: #fff;
    }

    .cart-drawer-footer {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 20px;
        background: #fff;
        border-top: 1px solid #eee;
    }

    .cart-total {
        font-family: "stratos-black", sans-serif;
        font-size: 18px;
        margin-bottom: 15px;
    }

    .checkout-button {
        width: 100%;
        background: #000;
        color: #fff;
        border: none;
        padding: 12px;
        border-radius: 4px;
        font-family: "stratos-black", sans-serif;
        font-size: 16px;
        cursor: pointer;
        transition: opacity 0.2s;
    }

    .checkout-button:hover {
        opacity: 0.9;
    }

    /* How It Works & FAQ Sections */
    .info-sections {
        width: 650px;
        margin: 20px auto;
        padding: 0;
        font-family: "Lucida Console", Courier, monospace;
        white-space: pre-line;
        line-height: 1.4;
    }

    .info-section {
        padding: 0;
        margin-bottom: 40px;
        width: 100%;
    }

    .info-section h2 {
        font-family: "Lucida Console", Courier, monospace;
        font-size: 32px;
        margin-bottom: 20px;
        font-weight: bold;
    }

    .info-section p {
        margin-bottom: 0;
        white-space: pre-line;
        line-height: 1.2;
        width: 100%;
    }

    .section-heading {
        font-weight: bold;
        font-size: 16px;
        margin: 20px 0 10px 0;
    }

    .label-format-box {
        background: #f9f9f9;
        padding: 15px;
        border: 1px solid #000;
        margin: 15px 0;
        border-radius: 4px;
        line-height: 1.2;
        width: 650px;
        box-sizing: border-box;
        margin-left: -2px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .label-format-content {
        flex: 1;
    }

    .label-format-image {
        width: 180px;
        margin: 15px auto 0 -30px;
        object-fit: contain;
    }

    .label-format-heading {
        font-weight: bold;
        margin-bottom: 10px;
        font-size: 16px;
    }

    .faq-item {
        margin-bottom: 45px;
    }

    .faq-item h3 {
        font-weight: normal;
        margin-bottom: 15px;
        margin-top: 0;
        white-space: pre-line;
    }

    .faq-item p {
        margin-top: 10px;
        line-height: 2;
        white-space: pre-line;
    }

    .faq-question, .faq-answer {
        width: 100%;
        box-sizing: border-box;
    }

    .faq-question {
        font-weight: bold;
        margin-bottom: 5px;
        font-size: 16px;
    }

    .faq-answer {
        margin-bottom: 25px;
        font-size: 14px;
        line-height: 1.2;
    }

    .address-box {
        background: #f9f9f9;
        padding: 15px;
        border: 1px solid #000;
        margin: 15px 0;
        border-radius: 4px;
        line-height: 1.2;
        width: 650px;
        box-sizing: border-box;
        margin-left: -2px;
    }

    .address-heading {
        font-weight: bold;
        margin-bottom: 10px;
        font-size: 16px;
    }
</style>
<body>
    <div class="container">
        <header>
            <h1 class="title">LAZY FILM LAB</h1>
            <a href="https://lazyfilms.in/store" class="email-link">BUY FILM</a>
        </header>
        
        <!-- Carousel Section -->
        <div class="carousel">
            <img src="1.jpg" alt="1" class="active">
            <img src="2.jpg" alt="2">
            <img src="3.jpg" alt="3">
            <img src="4.jpg" alt="4">
            <img src="5.jpg" alt="5">
            <img src="6.jpg" alt="6">
            <img src="7.jpg" alt="7">
            <img src="8.jpg" alt="8">
        </div>

        <!-- Order Form Section -->
        <div class="order-box">
            <button type="button" class="add-roll-btn" onclick="addNewRoll()">
                Add Roll
            </button>
            
            <form id="order-form">
                <div id="rolls-container">
                    <!-- Rolls will be added dynamically -->
                </div>

                <!-- Scans Section -->
                <div class="scans">
                    <h3>Scans</h3>
                    <div class="scans-options">
                        <label><input type="checkbox" name="scan-option" value="RAW"> RAW</label>
                        <label><input type="checkbox" name="scan-option" value="TIFF"> TIFF</label>
                        <label><input type="checkbox" name="scan-option" value="JPEG"> JPEG</label>
                    </div>
                </div>

                <!-- Return Negatives Option -->
                <div class="return-negatives-container">
                    <label>
                        <input type="checkbox" id="return-negatives"> Return my negatives (+â‚¹150)
                    </label>
                </div>

                <!-- Express Processing Option -->
                <div class="return-negatives-container">
                    <label>
                        <input type="checkbox" id="express-processing"> Express processing (+â‚¹500 per roll) â€” next-day delivery after arrival
                    </label>
                </div>

                <textarea placeholder="Additional notes"></textarea>

                <a href="#how-it-works" 
                   onclick="event.preventDefault(); document.getElementById('how-it-works').scrollIntoView({behavior: 'smooth'})" 
                   style="color: #0000EE; text-decoration: underline; font-size: 14px; display: block; margin-top: -15px; margin-bottom: 15px; cursor: pointer;">
                   How to send films â†’
                </a>

                <!-- Cart Summary -->
                <div class="cart-summary">
                    <h3>Cart Summary</h3>
                    <ul id="cart-items" class="cart-items"></ul>
                    <div class="cart-total">
                        Total: â‚¹<span id="total-price">0</span>
                    </div>
                </div>

                <button type="button" class="place-order" onclick="placeOrder()">Place Order</button>
            </form>
        </div>

        <!-- Add this before closing </div> of container -->
        <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #eee;">
            <div style="display: flex; justify-content: center; gap: 20px; font-size: 14px;">
                <a href="https://www.lazyfilms.in/labs/CONTACT" style="color: #000; text-decoration: none;">Contact</a>
                <a href="https://www.lazyfilms.in/labs/REFUND" style="color: #000; text-decoration: none;">Refund Policy</a>
                <a href="https://www.lazyfilms.in/labs/T&C" style="color: #000; text-decoration: none;">Terms & Conditions</a>
                <a href="https://www.lazyfilms.in/labs/PRIVACY_POLICY" style="color: #000; text-decoration: none;">Privacy Policy</a>
            </div>
        </footer>
    </div>

    <!-- Upsell Modal -->
    <div class="modal" id="upsellModal">
        <div class="modal-content">
            <h2>Add film at 10% OFF?</h2>
            <p style="margin-top: 10px;">Youâ€™re already sending in filmâ€”why not reload while youâ€™re at it? Snag fresh stock now with 10% off and <span style="color:#ff0000;">zero shipping costs</span> in the same order</p>
            <div style="display:flex; flex-direction:column; gap:12px; margin-top:16px; align-items:stretch;">
                <div style="flex:1; border:1px solid #000; border-radius:6px; padding:10px; background:#fff; display:flex; gap:10px; align-items:center; justify-content:space-between; width:100%;">
                    <img src="https://www.lazyfilms.in/store/images/lazy500-thumb.jpg" alt="LAZY 500" style="width:88px; height:auto; border:none; border-radius:4px;">
                    <div style="flex:1;">
                        <div style="font-weight:bold;">LAZY 500</div>
                        <div style="font-size:12px; color:#555;">10% OFF</div>
                    </div>
                    <div class="quantity-control" style="position:relative; display:inline-block;">
                        <button type="button" class="qty-btn" data-target="upsellQtyLazy500" style="left:0; position:absolute; top:0; bottom:0; width:24px; background:transparent; border:none;">âˆ’</button>
                        <input id="upsellQtyLazy500" type="number" value="1" min="1" style="width:72px; height:35px; border:1px solid #000; border-radius:4px; padding:0 24px; text-align:center;">
                        <button type="button" class="qty-btn" data-target="upsellQtyLazy500" data-inc="1" style="right:0; position:absolute; top:0; bottom:0; width:24px; background:transparent; border:none;">+</button>
                    </div>
                    <button type="button" id="addLazy500" style="background:#000; color:#fff; border:none; padding:8px 12px; border-radius:4px; cursor:pointer; white-space:nowrap;">Add</button>
                </div>
                <div style="flex:1; border:1px solid #000; border-radius:6px; padding:10px; background:#fff; display:flex; gap:10px; align-items:center; justify-content:space-between; width:100%;">
                    <img src="https://www.lazyfilms.in/store/images/lazy250-thumb.jpg" alt="LAZY 250" style="width:88px; height:auto; border:none; border-radius:4px;">
                    <div style="flex:1;">
                        <div style="font-weight:bold;">LAZY 250</div>
                        <div style="font-size:12px; color:#555;">10% OFF</div>
                    </div>
                    <div class="quantity-control" style="position:relative; display:inline-block;">
                        <button type="button" class="qty-btn" data-target="upsellQtyLazy250" style="left:0; position:absolute; top:0; bottom:0; width:24px; background:transparent; border:none;">âˆ’</button>
                        <input id="upsellQtyLazy250" type="number" value="1" min="1" style="width:72px; height:35px; border:1px solid #000; border-radius:4px; padding:0 24px; text-align:center;">
                        <button type="button" class="qty-btn" data-target="upsellQtyLazy250" data-inc="1" style="right:0; position:absolute; top:0; bottom:0; width:24px; background:transparent; border:none;">+</button>
                    </div>
                    <button type="button" id="addLazy250" style="background:#000; color:#fff; border:none; padding:8px 12px; border-radius:4px; cursor:pointer; white-space:nowrap;">Add</button>
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="cancel-order" id="upsellSkip">Skip for now</button>
                <button type="button" class="confirm-order" id="upsellCheckout">Continue to checkout</button>
            </div>
        </div>
    </div>

    <!-- Order Form Modal -->
    <div class="modal" id="orderModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeOrderModal()">&times;</span>
            <h2>Order Details</h2>
            <form class="order-form" id="customerForm" onsubmit="submitOrderForm(event)">
                <div class="form-group">
                    <label>Name <span class="required">*</span></label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Email <span class="required">*</span></label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone <span class="required">*</span></label>
                    <input type="tel" name="phone" pattern="[0-9]{10}" required>
                </div>
                <div class="form-group">
                    <label>Address <span class="required">*</span></label>
                    <input type="text" name="address" required>
                </div>
                <div class="form-group">
                    <label>City <span class="required">*</span></label>
                    <input type="text" name="city" required>
                </div>
                <div class="form-group">
                    <label>PIN Code <span class="required">*</span></label>
                    <input type="text" name="pincode" pattern="[0-9]{6}" required>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="cancel-order" onclick="closeOrderModal()">Cancel</button>
                    <button type="submit" class="confirm-order">Proceed to Payment</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Universal Cart Button -->
    <div class="universal-cart-button" onclick="toggleCartDrawer()">
        ðŸ›’
        <span class="cart-count-bubble">0</span>
    </div>

    <!-- Cart Drawer -->
    <div class="cart-drawer">
        <div class="cart-drawer-header">
            <h3>Your Cart</h3>
            <button onclick="toggleCartDrawer()">âœ•</button>
        </div>
        <div class="cart-items-container">
            <!-- Cart items will be dynamically added here -->
        </div>
        <div class="cart-drawer-footer">
            <div class="cart-total">Total: â‚¹0</div>
            <button class="checkout-button" onclick="universalCheckout()">Checkout</button>
        </div>
    </div>

    <!-- After the container div -->
    <div class="info-sections">
        <div class="info-section">
            <h2 id="how-it-works">// HOW IT WORKS</h2>
            <p>We offer high-quality 35mm and 120 film developing and scanning services at affordable rates. Our processing options include ECN-2, C-41, and Black & White.</p>

            <p class="section-heading">How to pack & send your films :</p>
            <p>
Select the number of rolls of ECN2/C41/BnW above. If you're not sure which process it is, refer to the FAQ section.
Choose if you want to add push/pull process.</p>

            <div class="label-format-box">
                <div class="label-format-content">
                    <p class="label-format-heading">Label your rolls in this format :</p>
                    <p>
"YOUR_NAME_____"
"FILM_NAME_____"
"ISO_YOU_SHOT_ON_____"
"PROCESS_____" (Leave Blank if you're not sure)</p>
                </div>
                <img src="images/film-label.png" alt="Film Label Format" class="label-format-image">
            </div>

            <p>Wrap them in well in packaging material and ship it to the address below.</p>

            <div class="address-box">
                <p class="address-heading">Address :</p>
                <p>Lazy Film Lab
C-13, Sahar Co-operative Housing Society, Sahar road, Parsiwada Chakala, Andheri East, Mumbai - 400099
phone - 9405143371</p>
            </div>
        </div>

        <div class="info-section">
            <h2>// FAQ</h2>
            <div class="faq-question">I don't know which process my color rolls should be developed in - ECN-2 or C-41</div>
            <div class="faq-answer">If it's a respooled motion picture film like 250D, 500T, 200T, or 50D, it's ideally processed in ECN-2 for better colors.
Photo films like Kodak Gold, Kodak Portra, or Fujifilms should be processed in C-41.
If you're still unsure about the process, just write the ISO you shot on and send it in.</div>

            <div class="faq-question">My films have Remjet. Is that okay?</div>
            <div class="faq-answer">Yes, it's perfectly okay to send a Remjet-backed motion picture film. We remove the Remjet and process the film in ECN-2.</div>

            <div class="faq-question">What scanning resolution will I get?</div>
            <div class="faq-answer">We scan with a full-frame mirrorless camera, which approximates a resolution of 6000 x 4000 pixels.
It's very high resolution and suitable for large prints.</div>

            <div class="faq-question">How do I get my negatives back?</div>
            <div class="faq-answer">You can check the "return my negatives" box, and we'll ship them back to your address for an additional courier charge.</div>

            <div class="faq-question">How should I label my rolls?</div>
            <div class="faq-answer">Simply mention your name, the film name, the ISO you shot on, and the process.For example: lazy-500T-800-ECN2. Check how to label your rolls.</div>

            <div class="faq-question">I have shot expired film. How should I proceed with processing?</div>
            <div class="faq-answer">The best way to use expired film is to overexpose it by +1 stop for every decade it's expired.
For example, a 200 ISO film expired in 2015 should be shot at 100 ISO.
If you've followed this method, we'll develop it at box speed, and it should work fine. Otherwise, you can shoot at box speed and let us know the year it expired.</div>

            <div class="faq-question">I want RAW negative files of my film. Can I get them?</div>
            <div class="faq-answer">Yes, you can select the format you want your digitized photos to be delivered in, including RAW files.</div>

            <div class="faq-question">Do you process Ektachrome?</div>
            <div class="faq-answer">Yes, we process Ektachrome, but not as a slide film in E-6 chemistry. We process it in ECN-2 as a negative.</div>

            <div class="faq-question">What is the turn-around time for digital scans?</div>
            <div class="faq-answer">Usually it is between 3-7 days after we receive the film rolls.</div>
        </div>
    </div>
</body>
<script>
    // Core Helper Functions
    function calculateTotal() {
        let total = 0;
        document.querySelectorAll('.roll-row').forEach(roll => {
            const quantity = parseInt(roll.querySelector('input[type="number"]').value) || 0;
            total += quantity * PRICE_PER_ROLL;
        });
        
        if (document.getElementById('return-negatives').checked) {
            total += 150;
        }
        if (document.getElementById('express-processing')?.checked) {
            let totalRolls = 0;
            document.querySelectorAll('.roll-row').forEach(roll => {
                const quantity = parseInt(roll.querySelector('input[type="number"]').value) || 0;
                totalRolls += quantity;
            });
            total += EXPRESS_FEE_PER_ROLL * totalRolls;
        }
        return total;
    }

    function getSelectedScans() {
        return Array.from(document.querySelectorAll('input[name="scan-option"]:checked'))
            .map(checkbox => checkbox.value);
    }

    function clearForm() {
        document.getElementById('rolls-container').innerHTML = '';
        document.getElementById('return-negatives').checked = false;
        const express = document.getElementById('express-processing');
        if (express) express.checked = false;
        document.querySelector('textarea').value = '';
        document.querySelectorAll('input[name="scan-option"]').forEach(checkbox => {
            checkbox.checked = false;
        });
        updateOrderSummary();
    }

    // Cart Functionality
    function toggleCartDrawer() {
        const drawer = document.querySelector('.cart-drawer');
        drawer.classList.toggle('active');
        if (drawer.classList.contains('active')) {
            updateCartDrawer();
        }
    }

    function updateCartDrawer() {
        const cartItemsContainer = document.querySelector('.cart-items-container');
        const cartTotal = document.querySelector('.cart-drawer-footer .cart-total');
        let total = 0;
        let cartHtml = '';

        // Add film processing items
        document.querySelectorAll('.roll-row').forEach(roll => {
            const filmName = roll.querySelector('input[type="text"]').value || 'Untitled Film';
            const quantity = parseInt(roll.querySelector('input[type="number"]').value) || 0;
            const processType = roll.querySelector('select:nth-of-type(1)').value;
            const pushPull = roll.querySelector('select:nth-of-type(2)').value;
            
            if (quantity > 0) {
                const itemTotal = quantity * PRICE_PER_ROLL;
                total += itemTotal;
                cartHtml += `
                    <div class="cart-item">
                        <div class="cart-item-details">
                            <h4>${quantity}Ã— ${filmName}</h4>
                            <p>${processType}${pushPull !== 'none' ? ', ' + pushPull : ''}</p>
                        </div>
                    <span>â‚¹${itemTotal}</span>
                    </div>`;
            }
        });

        // Add return negatives if checked
        if (document.getElementById('return-negatives').checked) {
            total += 150;
            cartHtml += `
                <div class="cart-item">
                    <div class="cart-item-details">
                        <h4>Return Negatives</h4>
                    </div>
                <span>â‚¹150</span>
                </div>`;
        }

        // Add express processing if checked
        const expressChecked = document.getElementById('express-processing').checked;
        if (expressChecked) {
            let totalRolls = 0;
            document.querySelectorAll('.roll-row').forEach(roll => {
                const quantity = parseInt(roll.querySelector('input[type="number"]').value) || 0;
                totalRolls += quantity;
            });
            const expressTotal = EXPRESS_FEE_PER_ROLL * totalRolls;
            total += expressTotal;
            cartHtml += `
                <div class="cart-item">
                    <div class="cart-item-details">
                        <h4>Express processing Ã— ${totalRolls}</h4>
                    </div>
                    <span>â‚¹${expressTotal}</span>
                </div>`;
        }

        cartItemsContainer.innerHTML = cartHtml;
        cartTotal.textContent = `Total: â‚¹${total}`;
    }

    function universalCheckout() {
        // Close cart drawer
        toggleCartDrawer();
        // Show order modal
        showOrderModal();
    }

    // Cart Functionality
    function createRollHtml(rollCount) {
        return `
            <div class="roll-row">
            <input type="text" placeholder="Film name" required>
            <input type="number" placeholder="Qty" min="1" max="30" required>
            <select required>
                <option value="" disabled selected>Process</option>
                    <option value="Ecn2">ECN-2</option>
                    <option value="c41">C41</option>
                    <option value="BnW">Black & White</option>
            </select>
            <select required>
                <option value="none" selected>No Push/Pull</option>
                <option value="push1">+1 Stop</option>
                <option value="push2">+2 Stop</option>
                <option value="push3">+3 Stop</option>
                <option value="pull1">-1 Stop</option>
                <option value="pull2">-2 Stop</option>
                <option value="pull3">-3 Stop</option>
                <option value="not-sure">Not sure</option>
            </select>
                <button type="button" class="remove-roll" onclick="removeRoll(this)">Ã—</button>
            </div>
        `;
    }

    function addNewRoll() {
        const rollsContainer = document.getElementById('rolls-container');
        const rollCount = rollsContainer.children.length + 1;
        
        const rollHtml = createRollHtml(rollCount);
        rollsContainer.insertAdjacentHTML('beforeend', rollHtml);
        
        const newRoll = rollsContainer.lastElementChild;
        newRoll.querySelectorAll('input, select').forEach(input => {
            input.addEventListener('change', () => {
                updateOrderSummary();
                updateCartDrawer();
            });
            input.addEventListener('input', () => {
                updateOrderSummary();
                updateCartDrawer();
            });
        });
        
        updateOrderSummary();
        updateCartDrawer();
        updateCartCount();
    }

    function updateOrderSummary() {
        const total = calculateTotal();
        document.getElementById('total-price').textContent = total;
        updateCartCount();
    }

    function updateCartCount() {
        const rollCount = document.querySelectorAll('.roll-row').length;
        const cartCountBubble = document.querySelector('.cart-count-bubble');
        cartCountBubble.textContent = rollCount;
        
        // Hide bubble if no items
        if (rollCount === 0) {
            cartCountBubble.style.display = 'none';
        } else {
            cartCountBubble.style.display = 'flex';
        }
    }

    function removeRoll(button) {
        button.closest('.roll-row').remove();
        updateOrderSummary();
        updateCartDrawer();
        updateCartCount();
    }

    // Add event listener for return negatives checkbox
    document.getElementById('return-negatives').addEventListener('change', () => {
        updateOrderSummary();
        updateCartDrawer();
    });

    // Add event listener for express processing checkbox
    document.getElementById('express-processing').addEventListener('change', () => {
        updateOrderSummary();
        updateCartDrawer();
    });

    // Modal Functions
    function showOrderModal() {
        document.getElementById('orderModal').classList.add('active');
    }

    function closeOrderModal() {
        document.getElementById('orderModal').classList.remove('active');
    }

    // Upsell state
    let pendingOrderData = null;
    let upsellItems = [];

    // Resolve discounted upsell variants dynamically
    let upsellReady = false;
    async function resolveUpsellVariants() {
        try {
            // Try by known or likely handles first
            const handles = [
                'lazy500-10', 'lazy-500-10', 'lazy500-10-off', 'lazy-500-10-off', 'lazy500-10-percent', 'lazy-500-10-percent',
                'lazy250-10', 'lazy-250-10', 'lazy250-10-off', 'lazy-250-10-off', 'lazy250-10-percent', 'lazy-250-10-percent'
            ];

            const byHandleQuery = (handle) => `query($handle:String!) { product(handle:$handle) { title variants(first:1) { edges { node { id availableForSale } } } } }`;

            let found500 = null;
            let found250 = null;

            for (const handle of handles) {
                const res = await fetch(`https://${SHOPIFY_STORE_NAME}/api/2024-01/graphql.json`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Shopify-Storefront-Access-Token': STOREFRONT_ACCESS_TOKEN
                    },
                    body: JSON.stringify({ query: byHandleQuery(handle), variables: { handle } })
                });
                const json = await res.json();
                const product = json.data?.product;
                const title = product?.title?.toLowerCase?.() || '';
                const variantId = product?.variants?.edges?.[0]?.node?.id || null;
                if (!product || !variantId) continue;

                if (!found500 && title.includes('lazy 500') && title.includes('10')) {
                    found500 = variantId;
                }
                if (!found250 && title.includes('lazy 250') && title.includes('10')) {
                    found250 = variantId;
                }

                if (found500 && found250) break;
            }

            // Fallback: search by titles via a collection or generic search is not available on Storefront easily.
            // If not found, keep previous values (null) so buttons remain disabled.
            if (found500) VARIANT_LAZY500 = found500.split('/').pop();
            if (found250) VARIANT_LAZY250 = found250.split('/').pop();

            // Enable buttons if at least one is resolved
            const btn500 = document.getElementById('addLazy500');
            const btn250 = document.getElementById('addLazy250');
            if (btn500) btn500.disabled = !VARIANT_LAZY500;
            if (btn250) btn250.disabled = !VARIANT_LAZY250;

            upsellReady = !!(VARIANT_LAZY500 || VARIANT_LAZY250);
        } catch (err) {
            console.error('Failed to resolve upsell variants:', err);
        }
    }

    function placeOrder() {
        const rolls = document.querySelectorAll('.roll-row');
        let hasItems = false;
        let isValid = true;

        rolls.forEach(roll => {
            const quantity = parseInt(roll.querySelector('input[type="number"]').value) || 0;
            const filmName = roll.querySelector('input[type="text"]').value;
            const processType = roll.querySelector('select:nth-of-type(1)').value;

            if (quantity > 0) {
                hasItems = true;
                if (!filmName || !processType) {
                    isValid = false;
                }
            }
        });

        if (!hasItems) {
            alert('Please add at least one roll to proceed.');
            return;
        }

        if (!isValid) {
            alert('Please fill in all required fields for each roll.');
            return;
        }

        showOrderModal();
        // Kick off resolving upsell variants in background
        resolveUpsellVariants();
    }

    // Carousel Functionality
    let currentIndex = 0;
    
    function showNextImage() {
        try {
            const images = document.querySelectorAll('.carousel img');
            if (images.length === 0) {
                console.error('No carousel images found');
                return;
            }
            
            images[currentIndex].classList.remove('active');
            currentIndex = (currentIndex + 1) % images.length;
            images[currentIndex].classList.add('active');
            console.log('Carousel updated to image:', currentIndex + 1);
        } catch (error) {
            console.error('Error in carousel:', error);
        }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
        // Check if images are loaded
        const images = document.querySelectorAll('.carousel img');
        if (images.length > 0) {
            console.log('Found', images.length, 'carousel images');
            images[0].classList.add('active'); // Ensure first image is visible
            setInterval(showNextImage, 6000);
        } else {
            console.error('No carousel images found on load');
        }
        
        document.getElementById('return-negatives').addEventListener('change', updateOrderSummary);
        const express = document.getElementById('express-processing');
        if (express) express.addEventListener('change', updateOrderSummary);
        updateOrderSummary();
        // Attempt to resolve upsell variants on load
        applyUpsellOverridesFromUrl();
        resolveUpsellVariants();
    });

    // Update the submitOrderForm function
    async function submitOrderForm(event) {
        event.preventDefault();
        
        try {
            const form = event.target;
            const formData = new FormData(form);
            const customerData = Object.fromEntries(formData.entries());

            // Get selected scans
            const selectedScans = getSelectedScans();
            if (selectedScans.length === 0) {
                throw new Error('Please select at least one scan option');
            }

            // Collect roll data
            const items = Array.from(document.querySelectorAll('.roll-row'))
                .map(roll => {
                    const filmName = roll.querySelector('input[type="text"]').value;
                    const quantity = parseInt(roll.querySelector('input[type="number"]').value) || 0;
                    const processType = roll.querySelector('select:nth-of-type(1)').value;
                    const pushPull = roll.querySelector('select:nth-of-type(2)').value;

                    // Get variant ID based on process type and push/pull
                    const variantId = getVariantId(processType, pushPull);
                    if (!variantId) {
                        throw new Error(`Invalid variant combination: ${processType} ${pushPull}`);
                    }

                    return quantity > 0 && filmName && processType ? {
                        film_name: filmName,
                        quantity: quantity,
                        process_type: processType,
                        push_pull: pushPull,
                        variantId: variantId
                    } : null;
                })
                .filter(item => item !== null);

            if (items.length === 0) {
                throw new Error('Please add at least one film roll');
            }

            // Store order data and show upsell modal instead of immediate redirect
            pendingOrderData = {
                    items: items,
                customerInfo: customerData,
                    notes: document.querySelector('textarea').value || '',
                scans: selectedScans,
                returnNegatives: document.getElementById('return-negatives').checked,
                expressProcessing: document.getElementById('express-processing').checked
            };
            upsellItems = [];
            document.getElementById('orderModal').classList.remove('active');
            document.getElementById('upsellModal').classList.add('active');

        } catch (error) {
            console.error('Error in order submission:', error);
            alert('Failed to create order: ' + error.message);
        }
    }

    // Upsell handlers
    document.addEventListener('click', async (e) => {
        if (e.target && e.target.id === 'addLazy500') {
            if (!VARIANT_LAZY500) return;
            const qty = Math.max(1, parseInt(document.getElementById('upsellQtyLazy500')?.value) || 1);
            upsellItems.push({ variantId: VARIANT_LAZY500, quantity: qty });
            e.target.textContent = 'Added';
            e.target.disabled = true;
        }
        if (e.target && e.target.id === 'addLazy250') {
            if (!VARIANT_LAZY250) return;
            const qty = Math.max(1, parseInt(document.getElementById('upsellQtyLazy250')?.value) || 1);
            upsellItems.push({ variantId: VARIANT_LAZY250, quantity: qty });
            e.target.textContent = 'Added';
            e.target.disabled = true;
        }
        if (e.target && e.target.id === 'upsellSkip') {
            document.getElementById('upsellModal').classList.remove('active');
            const cart = await createShopifyCart(pendingOrderData, []);
            if (cart.checkoutUrl) window.location.href = cart.checkoutUrl;
        }
        if (e.target && e.target.id === 'upsellCheckout') {
            document.getElementById('upsellModal').classList.remove('active');
            const cart = await createShopifyCart(pendingOrderData, upsellItems);
            if (cart.checkoutUrl) window.location.href = cart.checkoutUrl;
        }
        // Quantity +/- inside upsell
        if (e.target && e.target.classList.contains('qty-btn')) {
            const targetId = e.target.getAttribute('data-target');
            const input = document.getElementById(targetId);
            if (input) {
                const inc = e.target.getAttribute('data-inc') ? 1 : -1;
                const next = Math.max(1, (parseInt(input.value) || 1) + inc);
                input.value = next;
            }
        }
    });

    // Allow overriding upsell variant IDs via URL params for immediate fix
    function applyUpsellOverridesFromUrl() {
        try {
            const params = new URLSearchParams(window.location.search);
            const v500 = params.get('lazy500_10');
            const v250 = params.get('lazy250_10');
            if (v500) VARIANT_LAZY500 = String(v500).split('/').pop();
            if (v250) VARIANT_LAZY250 = String(v250).split('/').pop();
            const express = params.get('express');
            if (express) EXPRESS_VARIANT_ID = String(express).split('/').pop();
            const btn500 = document.getElementById('addLazy500');
            const btn250 = document.getElementById('addLazy250');
            if (btn500) btn500.disabled = false;
            if (btn250) btn250.disabled = false;
        } catch (e) {
            console.warn('Failed to apply upsell overrides from URL', e);
        }
    }

    // Update the getVariantId function
    function getVariantId(processType, pushPull) {
        const variantMap = {
            'ECN-2': {
                'none': 'gid://shopify/ProductVariant/43181189103715',    // No Push/Pull
                'push1': 'gid://shopify/ProductVariant/43181189136483',   // +1 Stop
                'push2': 'gid://shopify/ProductVariant/43181189169251',   // +2 Stop
                'push3': 'gid://shopify/ProductVariant/43181189202019',   // +3 Stop
                'pull1': 'gid://shopify/ProductVariant/43181189234787',   // -1 Stop
                'pull2': 'gid://shopify/ProductVariant/43181189267555',   // -2 Stop
                'pull3': 'gid://shopify/ProductVariant/43181189300323',   // -3 Stop
                'not-sure': 'gid://shopify/ProductVariant/43181189333091' // Not sure
            },
            'C41': {
                'none': 'gid://shopify/ProductVariant/43181189365859',    // No Push/Pull
                'push1': 'gid://shopify/ProductVariant/43181189398627',   // +1 Stop
                'push2': 'gid://shopify/ProductVariant/43181189431395',   // +2 Stop
                'push3': 'gid://shopify/ProductVariant/43181189464163',   // +3 Stop
                'pull1': 'gid://shopify/ProductVariant/43181189496931',   // -1 Stop
                'pull2': 'gid://shopify/ProductVariant/43181189529699',   // -2 Stop
                'pull3': 'gid://shopify/ProductVariant/43181189562467',   // -3 Stop
                'not-sure': 'gid://shopify/ProductVariant/43181189595235' // Not sure
            },
            'B&W': {
                'none': 'gid://shopify/ProductVariant/43181189628003',    // No Push/Pull
                'push1': 'gid://shopify/ProductVariant/43181189660771',   // +1 Stop
                'push2': 'gid://shopify/ProductVariant/43181189693539',   // +2 Stop
                'push3': 'gid://shopify/ProductVariant/43181189726307'    // +3 Stop
            }
        };
        
        // Convert process type to match Shopify variants
        const processMap = {
            'Ecn2': 'ECN-2',
            'c41': 'C41',
            'BnW': 'B&W'
        };

        // Convert push/pull to match variant names
        const pushPullMap = {
            'none': 'none',
            'push1': 'push1',
            'push2': 'push2',
            'pull1': 'pull1',
            'pull2': 'pull2'
        };

        const mappedProcess = processMap[processType] || processType;
        const mappedPushPull = pushPullMap[pushPull] || pushPull;

        return variantMap[mappedProcess]?.[mappedPushPull] || null;
    }

    // Update the createShopifyCart function
    async function createShopifyCart(orderData, extraItems = []) {
        try {
            let checkoutUrl = `https://${SHOPIFY_STORE_NAME}/cart/`;
            
            // Add items to URL (simple version)
            const items = orderData.items.map(item => {
                const variantId = String(item.variantId).split('/').pop();
                return `${variantId}:${item.quantity}`;
            });
            // Include upsell items
            extraItems.forEach(extra => {
                const vid = String(extra.variantId).split('/').pop();
                if (vid) items.push(`${vid}:${extra.quantity || 1}`);
            });
            
            if (orderData.returnNegatives) {
                items.push('43199974604899:1');
            }
            if (orderData.expressProcessing) {
                // Charge per roll either via variant or fallback to note only
                let totalRolls = 0;
                orderData.items.forEach(i => totalRolls += (i.quantity || 0));
                if (EXPRESS_VARIANT_ID) {
                    const vid = String(EXPRESS_VARIANT_ID).split('/').pop();
                    if (vid && totalRolls > 0) items.push(`${vid}:${totalRolls}`);
                }
            }

            // Join items with commas
            checkoutUrl += items.join(',');

            // Create detailed order notes
            const orderDetails = orderData.items.map(item => 
                `â€¢ Film: ${item.film_name}\n` +
                `  Process: ${item.process_type}\n` +
                `  Push/Pull: ${item.push_pull}\n` +
                `  Quantity: ${item.quantity}`
            ).join('\n\n');

            const expressNote = orderData.expressProcessing ? '\nExpress: YES (â‚¹500/roll, next-day after arrival)' : '';

            // Add basic parameters
            const params = new URLSearchParams({
                'checkout[email]': orderData.customerInfo.email,
                'checkout[shipping_address][first_name]': orderData.customerInfo.name,
                'checkout[shipping_address][address1]': orderData.customerInfo.address,
                'checkout[shipping_address][city]': orderData.customerInfo.city,
                'checkout[shipping_address][zip]': orderData.customerInfo.pincode,
                'checkout[shipping_address][country]': 'India',
                'checkout[shipping_address][province]': 'Maharashtra',
                'note': `ORDER DETAILS:\n\n${orderDetails}\n\nScans: ${orderData.scans.join(', ')}\nNotes: ${orderData.notes}${expressNote}`
            });

            checkoutUrl += '?' + params.toString();

            console.log('Checkout URL:', checkoutUrl);

            return { checkoutUrl };
        } catch (error) {
            console.error('Cart creation error:', error);
            throw error;
        }
    }

    // Update the getProductVariants function to check inventory
    async function getProductVariants() {
        try {
            const response = await fetch(`https://${SHOPIFY_STORE_NAME}/api/2024-01/graphql.json`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Shopify-Storefront-Access-Token': STOREFRONT_ACCESS_TOKEN
                },
                body: JSON.stringify({
                    query: `{
                        product(handle: "film-processing") {
                            title
                            variants(first: 20) {
                                edges {
                                    node {
                                        id
                                        title
                                        availableForSale
                                        quantityAvailable
                                    }
                                }
                            }
                        }
                    }`
                })
            });

            const data = await response.json();
            console.log('Product Data:', data);
            return data;
        } catch (error) {
            console.error('Error:', error);
        }
    }

    // Update the testCartCreation function
    async function testCartCreation() {
        try {
            // Sample order data
            const testOrder = {
            items: [{
                film_name: "Test Film",
                quantity: 1,
                    process_type: "ECN-2",
                push_pull: "none",
                    variantId: "gid://shopify/ProductVariant/43181189103715"
                }],
                customerInfo: {
                    name: "Test User",
                    email: "test@example.com",
                    phone: "+911234567890", // Add country code
                    address: "Test Address, Mumbai",
                    city: "Mumbai",
                    pincode: "400001",
                    country: "India"
                },
                notes: "Test order",
            scans: ["JPEG"]
        };

            // Create cart
            const cart = await createShopifyCart(testOrder);
            console.log('Cart created:', cart);
            
            if (cart.checkoutUrl) {
                // Open in same window for better payment flow
                window.location.href = cart.checkoutUrl;
            }
        } catch (error) {
            console.error('Test cart creation failed:', error);
            alert('Cart creation failed: ' + error.message);
        }
    }
</script>

</html>

